(()=>{"use strict";const e=window.React,t=window.wp.blocks,s=window.wp.blockEditor,n=window.wp.components,o=window.wp.element,l=window.wp.data,r=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"irecommendthis/recommend","version":"4.0.0","title":"I Recommend This","category":"widgets","icon":"thumbs-up","description":"Block to add recommend link.","supports":{"html":false},"attributes":{"postId":{"type":"number","default":null},"alignText":{"type":"string","default":"left"},"useCurrentPost":{"type":"boolean","default":true}},"textdomain":"i-recommend-this","editorScript":"file:./index.js"}');(0,t.registerBlockType)(r,{edit({attributes:t,setAttributes:r,context:i,clientId:a}){const{postId:c,alignText:u,useCurrentPost:m}=t,[d,p]=(0,o.useState)(null),[h,I]=(0,o.useState)(!1),g=(0,s.useBlockProps)({className:`has-text-align-${u}`}),w=(0,l.useSelect)((e=>{const{getCurrentPostId:t}=e("core/editor");return t?t():null}),[]),b=i?.postId||null;(0,o.useEffect)((()=>{m&&(b?c!==b&&r({postId:b}):w&&c!==w&&r({postId:w}))}),[m,b,w,c,r]);const v=m?b||w:c;return(0,e.createElement)("div",{...g},(0,e.createElement)(s.BlockControls,null,(0,e.createElement)(s.AlignmentToolbar,{value:u,onChange:e=>r({alignText:e})})),(0,e.createElement)(s.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:"Settings"},(0,e.createElement)(n.ToggleControl,{label:"Use current post in query loops",checked:m,onChange:()=>{r(m?{useCurrentPost:!1}:{useCurrentPost:!0,postId:b||w||null}),p(null)},help:m?"In query loops, the plugin will use each post's ID automatically.":"Using a specific post ID for all instances."}),!m&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(n.TextControl,{label:"Specific Post ID",value:null==c?"":c,onChange:e=>{try{if(""===e)return r({postId:null}),void p(null);const t=parseInt(e,10);if(isNaN(t)||t<=0)return void p("Please enter a valid post ID (a positive number)");r({postId:t}),p(null)}catch(e){p("Invalid post ID format")}},type:"number",min:"1"}),d&&(0,e.createElement)(n.Notice,{status:"error",isDismissible:!1},d)),b&&(0,e.createElement)(n.Notice,{status:"info",isDismissible:!1},"This block is inside a Query Loop. Post ID: ",b))),h?(0,e.createElement)(n.Placeholder,null,(0,e.createElement)(n.Spinner,null)):(()=>{if(!v)return(0,e.createElement)(n.Notice,{status:"warning",isDismissible:!1},"No valid post ID available. Please select a post or provide an ID.");const t=m?'[irecommendthis use_current_post="true"]':`[irecommendthis id="${v}"]`;return(0,e.createElement)("div",{className:"recommend-preview"},(0,e.createElement)("div",{className:"recommend-shortcode"},t),(0,e.createElement)("div",{className:"recommend-info"},"Using post ID: ",v||"Unknown"))})())},save({attributes:t}){const{postId:n,alignText:o,useCurrentPost:l}=t,r=s.useBlockProps.save({className:`has-text-align-${o}`});return(0,e.createElement)("div",{...r},l?'[irecommendthis use_current_post="true"]':`[irecommendthis id="${n}"]`)}})})();