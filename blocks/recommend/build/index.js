(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.blocks,n=window.wp.blockEditor,o=window.wp.components,r=window.wp.element,l=window.wp.data,i=window.wp.serverSideRender;var a=e.n(i);const c=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"irecommendthis/recommend","version":"4.0.0","title":"I Recommend This","category":"widgets","icon":"thumbs-up","description":"Block to add recommend link.","supports":{"html":false,"align":true,"alignWide":false,"customClassName":true,"inserterScope":"block-editor"},"attributes":{"postId":{"type":"number","default":null},"alignText":{"type":"string","default":"left"},"useCurrentPost":{"type":"boolean","default":true},"isEditorPreview":{"type":"boolean","default":false}},"textdomain":"i-recommend-this","editorScript":"file:./index.js","editorStyle":"irecommendthis-editor-style","usesContext":["postId","postType"]}');(0,s.registerBlockType)(c,{edit({attributes:e,setAttributes:s,context:i,clientId:c}){const{postId:u,alignText:d,useCurrentPost:m}=e,[p,g]=(0,r.useState)(null),[w,b]=(0,r.useState)(!1),[h,I]=(0,r.useState)(!1),v=(0,n.useBlockProps)({className:`has-text-align-${d}`}),E=(0,l.useSelect)((e=>{const t=e.storeNames?Object.keys(e.storeNames()):[],s=t.includes("core/editor"),n=t.includes("core/edit-widgets");return I(n&&!s),s}),[]),f=(0,l.useSelect)((e=>{if(!E)return null;const t=e("core/editor");return t&&t.getCurrentPostId?t.getCurrentPostId():null}),[E]),y=i?.postId||null;(0,r.useEffect)((()=>{m&&(y?u!==y&&s({postId:y}):f&&u!==f&&s({postId:f}))}),[m,y,f,u,s]);const P=m?y||f:u;return h?(0,t.createElement)("div",{...v},(0,t.createElement)(o.Notice,{status:"warning",isDismissible:!1},(0,t.createElement)("p",null,(0,t.createElement)("strong",null,"I Recommend This:")," This block is designed for post content."),(0,t.createElement)("p",null,'It may not work correctly in a widget area. Consider using the "Most Recommended Posts" widget instead.'))):(0,t.createElement)("div",{...v},(0,t.createElement)(n.BlockControls,null,(0,t.createElement)(n.AlignmentToolbar,{value:d,onChange:e=>s({alignText:e})})),(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(o.PanelBody,{title:"Settings"},(0,t.createElement)(o.ToggleControl,{label:"Use current post in query loops",checked:m,onChange:()=>{s(m?{useCurrentPost:!1}:{useCurrentPost:!0,postId:y||f||null}),g(null)},help:m?"In query loops, the plugin will use each post's ID automatically.":"Using a specific post ID for all instances.",__nextHasNoMarginBottom:!0}),!m&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(o.TextControl,{label:"Specific Post ID",value:null==u?"":u,onChange:e=>{try{if(""===e)return s({postId:null}),void g(null);const t=parseInt(e,10);if(isNaN(t)||t<=0)return void g("Please enter a valid post ID (a positive number)");s({postId:t}),g(null)}catch(e){g("Invalid post ID format")}},type:"number",min:"1",__nextHasNoMarginBottom:!0}),p&&(0,t.createElement)(o.Notice,{status:"error",isDismissible:!1},p)),y&&(0,t.createElement)(o.Notice,{status:"info",isDismissible:!1},"This block is inside a Query Loop. Post ID: ",y))),w?(0,t.createElement)(o.Placeholder,null,(0,t.createElement)(o.Spinner,null)):(0,t.createElement)("div",{className:"irecommendthis-preview"},P?(0,t.createElement)(a(),{block:"irecommendthis/recommend",attributes:{postId:P,alignText:d,useCurrentPost:m,isEditorPreview:!0}}):(0,t.createElement)(o.Notice,{status:"warning",isDismissible:!1},"No valid post ID available. Please select a post or provide an ID.")))},save({attributes:e}){const{postId:s,alignText:o,useCurrentPost:r}=e,l=n.useBlockProps.save({className:`has-text-align-${o}`});return(0,t.createElement)("div",{...l},r?'[irecommendthis use_current_post="true"]':`[irecommendthis id="${s}"]`)}})})();